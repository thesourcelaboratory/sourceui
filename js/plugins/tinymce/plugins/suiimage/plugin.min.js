tinymce.PluginManager.add('suiimage', function(editor, url) {

    editor.addButton('suiimage', {
        icon: 'x icon-photo',
        tooltip: "Inserir imagens",
        onclick: function() {
            var $field = $(editor.getElement()).closest('sui-field');
            sourceui.instances.interface.plugins.sector.float({
                caller: $field,
                title: 'Seletor',
                size: 'large',
                link: editor.settings.browse.image,
                on: {
                    'alias:attach' : {
                        bind: '.sui-widget.explorer, .sui-widget.upload',
                        fn: function(imgs){
                            $(imgs).each(function(){
                                var $img = $(this);
                                editor.insertContent(
                                    '<div class="responsive-wrap">'+
                                        '<img src="'+$img.data('src')+'" title="'+$img.data('title')+'" class="fr-fic fr-dib"/>'+
                                    '</div>'
                                );
                            });
                        }
                    },
                    'alias:attach-middle' : {
                        bind: '.sui-widget.explorer, .sui-widget.upload',
                        fn: function(imgs){
                            $(imgs).each(function(){
                                var $img = $(this);
                                editor.insertContent(
                                    '<div class="responsive-wrap">'+
                                        '<img src="'+$img.data('src')+'" title="'+$img.data('title')+'" class="fr-fic fr-dib"/>'+
                                    '</div>'
                                );
                            });
                        }
                    },
                    'alias:attach-right' : {
                        bind: '.sui-widget.explorer, .sui-widget.upload',
                        fn: function(imgs){
                            $(imgs).each(function(){
                                var $img = $(this);
                               editor.insertContent(
                                    '<div class="responsive-wrap">'+
                                        '<p>Insira um texto aqui</p>'+
                                        '<img src="'+$img.data('src')+'" title="'+$img.data('title')+'" class="fr-fic fr-dib"/>'+
                                    '</div>'
                                );
                            });
                        }
                    },
                    'alias:attach-center' : {
                        bind: '.sui-widget.explorer, .sui-widget.upload',
                        fn: function(imgs){
                            $(imgs).each(function(){
                                var $img = $(this);
                               editor.insertContent(
                                    '<div class="responsive-wrap">'+
                                        '<p>Insira um texto aqui</p>'+
                                        '<img src="'+$img.data('src')+'" title="'+$img.data('title')+'" class="fr-fic fr-dib"/>'+
                                        '<p>Insira um texto aqui</p>'+
                                    '</div>'
                                );
                            });
                        }
                    },
                    'alias:attach-left' : {
                        bind: '.sui-widget.explorer, .sui-widget.upload',
                        fn: function(imgs){
                            $(imgs).each(function(){
                                var $img = $(this);
                               editor.insertContent(
                                    '<div class="responsive-wrap">'+
                                        '<img src="'+$img.data('src')+'" title="'+$img.data('title')+'" class="fr-fic fr-dib"/>'+
                                        '<p>Insira um texto aqui</p>'+
                                    '</div>'
                                );
                            });
                        }
                    }
                }
            });
        }
    });

    return {
        getMetadata: function () {
            return  {
                title: "Example plugin",
                url: "http://exampleplugindocsurl.com"
            };
        }
    };
});
